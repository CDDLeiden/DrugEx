<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>drugex.training package &mdash; DrugEx 3.4.3 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="drugex.training.explorers package" href="drugex.training.explorers.html" />
    <link rel="prev" title="drugex.parallel package" href="drugex.parallel.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> DrugEx
          </a>
              <div class="version">
                v3.4.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use.html#cli-example">CLI Example</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">DrugEx Python API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="drugex.html">drugex package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="drugex.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="drugex.data.html">drugex.data package</a></li>
<li class="toctree-l4"><a class="reference internal" href="drugex.logs.html">drugex.logs package</a></li>
<li class="toctree-l4"><a class="reference internal" href="drugex.molecules.html">drugex.molecules package</a></li>
<li class="toctree-l4"><a class="reference internal" href="drugex.parallel.html">drugex.parallel package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">drugex.training package</a></li>
<li class="toctree-l4"><a class="reference internal" href="drugex.utils.html">drugex.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="drugex.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="drugex.html#module-drugex.about">drugex.about module</a></li>
<li class="toctree-l3"><a class="reference internal" href="drugex.html#module-drugex.dataset">drugex.dataset module</a></li>
<li class="toctree-l3"><a class="reference internal" href="drugex.html#drugex-designer-module">drugex.designer module</a></li>
<li class="toctree-l3"><a class="reference internal" href="drugex.html#module-drugex.download">drugex.download module</a></li>
<li class="toctree-l3"><a class="reference internal" href="drugex.html#module-drugex.train">drugex.train module</a></li>
<li class="toctree-l3"><a class="reference internal" href="drugex.html#module-drugex">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DrugEx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">DrugEx Python API</a> &raquo;</li>
          <li><a href="drugex.html">drugex package</a> &raquo;</li>
      <li>drugex.training package</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="drugex-training-package">
<h1>drugex.training package<a class="headerlink" href="#drugex-training-package" title="Permalink to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="drugex.training.explorers.html">drugex.training.explorers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.explorers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.explorers.html#module-drugex.training.explorers.frag_graph_explorer">drugex.training.explorers.frag_graph_explorer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.explorers.html#module-drugex.training.explorers.frag_sequence_explorer">drugex.training.explorers.frag_sequence_explorer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.explorers.html#module-drugex.training.explorers.interfaces">drugex.training.explorers.interfaces module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.explorers.html#module-drugex.training.explorers.sequence_explorer">drugex.training.explorers.sequence_explorer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.explorers.html#module-drugex.training.explorers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drugex.training.generators.html">drugex.training.generators package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.generators.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.generators.html#module-drugex.training.generators.graph_transformer">drugex.training.generators.graph_transformer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.generators.html#module-drugex.training.generators.interfaces">drugex.training.generators.interfaces module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.generators.html#module-drugex.training.generators.sequence_rnn">drugex.training.generators.sequence_rnn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.generators.html#module-drugex.training.generators.sequence_transformer">drugex.training.generators.sequence_transformer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.generators.html#module-drugex.training.generators.utils">drugex.training.generators.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.generators.html#module-drugex.training.generators">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="drugex.training.scorers.html">drugex.training.scorers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers.interfaces">drugex.training.scorers.interfaces module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers.modifiers">drugex.training.scorers.modifiers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers.properties">drugex.training.scorers.properties module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers.qsprpred">drugex.training.scorers.qsprpred module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#drugex-training-scorers-ra-scorer-module">drugex.training.scorers.ra_scorer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers.sascorer">drugex.training.scorers.sascorer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers.similarity">drugex.training.scorers.similarity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers.smiles">drugex.training.scorers.smiles module</a></li>
<li class="toctree-l2"><a class="reference internal" href="drugex.training.scorers.html#module-drugex.training.scorers">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-drugex.training.environment">
<span id="drugex-training-environment-module"></span><h2>drugex.training.environment module<a class="headerlink" href="#module-drugex.training.environment" title="Permalink to this heading"></a></h2>
<p>environment</p>
<p>Created by: Martin Sicho
On: 06.06.22, 16:51</p>
<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.environment.DrugExEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.environment.</span></span><span class="sig-name descname"><span class="pre">DrugExEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scorers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/environment.html#DrugExEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.environment.DrugExEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.Environment" title="drugex.training.interfaces.Environment"><code class="xref py py-class docutils literal notranslate"><span class="pre">Environment</span></code></a></p>
<p>Original implementation of the environment scoring strategy for DrugEx v3.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.environment.DrugExEnvironment.getScores">
<span class="sig-name descname"><span class="pre">getScores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_multifrag_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/environment.html#DrugExEnvironment.getScores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.environment.DrugExEnvironment.getScores" title="Permalink to this definition"></a></dt>
<dd><p>This method is used to get the scores from the scorers and to check molecule validity and desireability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<em>list of str</em>) – List of SMILES strings to score.</p></li>
<li><p><strong>frags</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of SMILES strings of fragments to check for.</p></li>
<li><p><strong>no_multifrag_smiles</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to check for SMILES strings that contain more than one fragment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>preds</strong> – Dataframe with the scores from the scorers and the validity and desireability of the molecules.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.environment.DrugExEnvironment.getUnmodifiedScores">
<span class="sig-name descname"><span class="pre">getUnmodifiedScores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/environment.html#DrugExEnvironment.getUnmodifiedScores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.environment.DrugExEnvironment.getUnmodifiedScores" title="Permalink to this definition"></a></dt>
<dd><p>This method is used to get the scores from the scorers without any modifications.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smiles</strong> (<em>list of str</em>) – List of SMILES strings to score.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>preds</strong> – Dataframe with the scores from the scorers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-drugex.training.interfaces">
<span id="drugex-training-interfaces-module"></span><h2>drugex.training.interfaces module<a class="headerlink" href="#module-drugex.training.interfaces" title="Permalink to this heading"></a></h2>
<p>interfaces</p>
<p>Created by: Martin Sicho
On: 01.06.22, 11:29</p>
<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.interfaces.Environment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.interfaces.</span></span><span class="sig-name descname"><span class="pre">Environment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scorers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reward_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Environment" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.ModelEvaluator" title="drugex.training.interfaces.ModelEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelEvaluator</span></code></a></p>
<p>Definition of the generic environment class for DrugEx. Reference implementation is <a class="reference internal" href="#drugex.training.environment.DrugExEnvironment" title="drugex.training.environment.DrugExEnvironment"><code class="xref any py py-class docutils literal notranslate"><span class="pre">DrugExEnvironment</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Environment.getRewards">
<span class="sig-name descname"><span class="pre">getRewards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Environment.getRewards"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Environment.getRewards" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the single value as the reward for each molecule used for reinforcement learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of SMILES strings of the molecules to score.</p></li>
<li><p><strong>frags</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – List of SMILES strings of the fragments used to generate the molecules.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of rewards for the molecules.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Environment.getScorerKeys">
<span class="sig-name descname"><span class="pre">getScorerKeys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Environment.getScorerKeys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Environment.getScorerKeys" title="Permalink to this definition"></a></dt>
<dd><p>Get the keys of the scorers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of keys of the scorers.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Environment.getScores">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">getScores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Environment.getScores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Environment.getScores" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the scores of all objectives per molecule and qualify generated molecules (valid, accurate, desired).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of SMILES strings of the molecules to score.</p></li>
<li><p><strong>frags</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>, </em><em>optional</em>) – List of SMILES strings of the fragments used to generate the molecules.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A DataFrame with the scores and qualifications for the molecules.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Environment.getUnmodifiedScores">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">getUnmodifiedScores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Environment.getUnmodifiedScores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Environment.getUnmodifiedScores" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the scores without applying modifiers of all objectives per molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of SMILES strings of the molecules to score.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A DataFrame with the scores for the molecules.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.interfaces.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.interfaces.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>, <a class="reference internal" href="#drugex.training.interfaces.ModelProvider" title="drugex.training.interfaces.ModelProvider"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelProvider</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/abc.html#abc.ABC" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Generic base class for all PyTorch models in DrugEx. Manages the GPU or CPU gpus available to the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Model.attachToGPUs">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">attachToGPUs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Model.attachToGPUs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Model.attachToGPUs" title="Permalink to this definition"></a></dt>
<dd><p>Use this method to handle a request to change the used GPUs. This method is automatically called when the class is instantiated, but may need to be called again in subclasses to move all data to the required devices.</p>
<p>Subclasses should also make sure to set “self.device” to the currently used device and “self.gpus” to GPU ids of the currently used GPUs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>gpus</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Tuple of GPU ids to use.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Model.fit">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Model.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Model.fit" title="Permalink to this definition"></a></dt>
<dd><p>Train and validate the model with a given training and validation loader (see <a class="reference internal" href="drugex.data.html#drugex.data.interfaces.DataSet" title="drugex.data.interfaces.DataSet"><code class="xref any py py-class docutils literal notranslate"><span class="pre">DataSet</span></code></a> and its implementations docs to learn how to generate them).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loader</strong> (<em>torch.utils.data.DataLoader</em>) – The training data loader.</p></li>
<li><p><strong>valid_loader</strong> (<em>torch.utils.data.DataLoader</em>) – The validation data loader.</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The number of epochs to train the model for.</p></li>
<li><p><strong>monitor</strong> (<a class="reference internal" href="#drugex.training.interfaces.TrainingMonitor" title="drugex.training.interfaces.TrainingMonitor"><em>TrainingMonitor</em></a><em>, </em><em>optional</em>) – A <a class="reference internal" href="#drugex.training.interfaces.TrainingMonitor" title="drugex.training.interfaces.TrainingMonitor"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TrainingMonitor</span></code></a> instance to monitor the training process.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments to pass to the training loop.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Model.loadStates">
<span class="sig-name descname"><span class="pre">loadStates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Model.loadStates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Model.loadStates" title="Permalink to this definition"></a></dt>
<dd><p>Load the model states from a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – The dictionary containing the model states.</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to raise an error if the dictionary contains keys that do not match the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Model.loadStatesFromFile">
<span class="sig-name descname"><span class="pre">loadStatesFromFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Model.loadStatesFromFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Model.loadStatesFromFile" title="Permalink to this definition"></a></dt>
<dd><p>Load the model states from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The path to the file containing the model states.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.interfaces.Model.training">
<span class="sig-name descname"><span class="pre">training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3.9/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></em><a class="headerlink" href="#drugex.training.interfaces.Model.training" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.Model.updateDevices">
<span class="sig-name descname"><span class="pre">updateDevices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#Model.updateDevices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.Model.updateDevices" title="Permalink to this definition"></a></dt>
<dd><p>Update the device and GPUs used by the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device</strong> (<em>torch.device</em>) – The device to use for the model.</p></li>
<li><p><strong>gpus</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of GPUs to use for the model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.interfaces.ModelEvaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.interfaces.</span></span><span class="sig-name descname"><span class="pre">ModelEvaluator</span></span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#ModelEvaluator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.ModelEvaluator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/abc.html#abc.ABC" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>A simple function to score a model based on the generated molecules and input fragments if applicable.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.interfaces.ModelProvider">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.interfaces.</span></span><span class="sig-name descname"><span class="pre">ModelProvider</span></span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#ModelProvider"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.ModelProvider" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/abc.html#abc.ABC" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Any instance that contains a DrugEx <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> or its serialized form (i.e a state dictionary).</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.ModelProvider.getModel">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">getModel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#ModelProvider.getModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.ModelProvider.getModel" title="Permalink to this definition"></a></dt>
<dd><p>Return the current model as a <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance or in serialized form.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The current model or its serialized form.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model">Model</a> or <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.interfaces.RankingStrategy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.interfaces.</span></span><span class="sig-name descname"><span class="pre">RankingStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#RankingStrategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.RankingStrategy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/abc.html#abc.ABC" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Ranks the given molecules according to their scores.</p>
<p>The implementing classes can get a pareto front by calling <a class="reference internal" href="#drugex.training.interfaces.RankingStrategy.getParetoFronts" title="drugex.training.interfaces.RankingStrategy.getParetoFronts"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">RankingStrategy.getParetoFronts()</span></code></a> on the input scores.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.RankingStrategy.getParetoFronts">
<span class="sig-name descname"><span class="pre">getParetoFronts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#RankingStrategy.getParetoFronts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.RankingStrategy.getParetoFronts" title="Permalink to this definition"></a></dt>
<dd><p>Returns Pareto fronts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scores</strong> (<em>np.ndarray</em>) – Matrix of scores for the multiple objectives</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class="pre">list</span></code></a> of Pareto fronts. Each front is a <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref any docutils literal notranslate"><span class="pre">list</span></code></a> of indices of the molecules in the Pareto front.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.interfaces.RewardScheme">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.interfaces.</span></span><span class="sig-name descname"><span class="pre">RewardScheme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#RewardScheme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.RewardScheme" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/abc.html#abc.ABC" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Reward scheme that enables ranking of molecules based on the calculated objectives and other criteria.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="drugex.training.interfaces.RewardScheme.RewardException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RewardException</span></span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#RewardScheme.RewardException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.RewardScheme.RewardException" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3.9/library/exceptions.html#Exception" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
<p>Exception to catch errors in the calculation of rewards.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.interfaces.TrainingMonitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.interfaces.</span></span><span class="sig-name descname"><span class="pre">TrainingMonitor</span></span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#TrainingMonitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.TrainingMonitor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.ModelProvider" title="drugex.training.interfaces.ModelProvider"><code class="xref py py-class docutils literal notranslate"><span class="pre">ModelProvider</span></code></a>, <a class="reference external" href="https://docs.python.org/3.9/library/abc.html#abc.ABC" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Interface used to monitor model training.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.TrainingMonitor.close">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#TrainingMonitor.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.TrainingMonitor.close" title="Permalink to this definition"></a></dt>
<dd><p>Close this monitor. Training has finished.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.TrainingMonitor.endStep">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">endStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#TrainingMonitor.endStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.TrainingMonitor.endStep" title="Permalink to this definition"></a></dt>
<dd><p>Notify the monitor that a step of the training has finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current training step (i.e. batch).</p></li>
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.TrainingMonitor.saveModel">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">saveModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#TrainingMonitor.saveModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.TrainingMonitor.saveModel" title="Permalink to this definition"></a></dt>
<dd><p>Save the state dictionary of the <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance currently being trained or serialize the model any other way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><em>Model</em></a>) – The model to save.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.TrainingMonitor.savePerformanceInfo">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">savePerformanceInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">performance_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#TrainingMonitor.savePerformanceInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.TrainingMonitor.savePerformanceInfo" title="Permalink to this definition"></a></dt>
<dd><p>Save the performance data for the current epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>performance_dict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dictionary with the performance data.</p></li>
<li><p><strong>df_smiles</strong> (<em>pd.DataFrame</em>) – A DataFrame with the SMILES of the molecules generated in the current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.interfaces.TrainingMonitor.saveProgress">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">saveProgress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/interfaces.html#TrainingMonitor.saveProgress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.interfaces.TrainingMonitor.saveProgress" title="Permalink to this definition"></a></dt>
<dd><p>Notifies the monitor of the current progress of the training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The current training step (i.e. batch).</p></li>
<li><p><strong>current_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The current epoch.</p></li>
<li><p><strong>total_steps</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The total number of training steps.</p></li>
<li><p><strong>total_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The total number of epochs.</p></li>
<li><p><strong>*args</strong> – Additional arguments depending on the model type.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments depending on the model type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-drugex.training.monitors">
<span id="drugex-training-monitors-module"></span><h2>drugex.training.monitors module<a class="headerlink" href="#module-drugex.training.monitors" title="Permalink to this heading"></a></h2>
<p>monitors</p>
<p>Created by: Martin Sicho
On: 02.06.22, 13:59</p>
<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.monitors.</span></span><span class="sig-name descname"><span class="pre">FileMonitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.TrainingMonitor" title="drugex.training.interfaces.TrainingMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingMonitor</span></code></a></p>
<p>A simple <a class="reference internal" href="#drugex.training.interfaces.TrainingMonitor" title="drugex.training.interfaces.TrainingMonitor"><code class="xref any py py-class docutils literal notranslate"><span class="pre">TrainingMonitor</span></code></a> implementation with file outputs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.appendTableToFile">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">appendTableToFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.appendTableToFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.appendTableToFile" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.close" title="Permalink to this definition"></a></dt>
<dd><p>Close this monitor. Training has finished.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.endStep">
<span class="sig-name descname"><span class="pre">endStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.endStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.endStep" title="Permalink to this definition"></a></dt>
<dd><p>Notify the monitor that a step of the training has finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current training step (i.e. batch).</p></li>
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.getModel">
<span class="sig-name descname"><span class="pre">getModel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.getModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.getModel" title="Permalink to this definition"></a></dt>
<dd><p>Return the current model as a <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance or in serialized form.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The current model or its serialized form.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model">Model</a> or <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.saveEpochData">
<span class="sig-name descname"><span class="pre">saveEpochData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.saveEpochData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.saveEpochData" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.saveModel">
<span class="sig-name descname"><span class="pre">saveModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.saveModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.saveModel" title="Permalink to this definition"></a></dt>
<dd><p>Save the model state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.saveMolecules">
<span class="sig-name descname"><span class="pre">saveMolecules</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.saveMolecules"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.saveMolecules" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.savePerformanceInfo">
<span class="sig-name descname"><span class="pre">savePerformanceInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">performance_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.savePerformanceInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.savePerformanceInfo" title="Permalink to this definition"></a></dt>
<dd><p>Save the performance data for the current epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>performance_dict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dictionary with the performance data.</p></li>
<li><p><strong>df_smiles</strong> (<em>pd.DataFrame</em>) – A DataFrame with the SMILES of the molecules generated in the current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.FileMonitor.saveProgress">
<span class="sig-name descname"><span class="pre">saveProgress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#FileMonitor.saveProgress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.FileMonitor.saveProgress" title="Permalink to this definition"></a></dt>
<dd><p>Save the current training progress: epoch, step, loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current step.</p></li>
<li><p><strong>current_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current epoch.</p></li>
<li><p><strong>total_steps</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The total number of steps.</p></li>
<li><p><strong>total_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The total number of epochs.</p></li>
<li><p><strong>loss</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The current training loss.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.monitors.NullMonitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.monitors.</span></span><span class="sig-name descname"><span class="pre">NullMonitor</span></span><a class="reference internal" href="../_modules/drugex/training/monitors.html#NullMonitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.NullMonitor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.TrainingMonitor" title="drugex.training.interfaces.TrainingMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingMonitor</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.NullMonitor.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#NullMonitor.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.NullMonitor.close" title="Permalink to this definition"></a></dt>
<dd><p>Close this monitor. Training has finished.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.NullMonitor.endStep">
<span class="sig-name descname"><span class="pre">endStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#NullMonitor.endStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.NullMonitor.endStep" title="Permalink to this definition"></a></dt>
<dd><p>Notify the monitor that a step of the training has finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current training step (i.e. batch).</p></li>
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.NullMonitor.getModel">
<span class="sig-name descname"><span class="pre">getModel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#NullMonitor.getModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.NullMonitor.getModel" title="Permalink to this definition"></a></dt>
<dd><p>Return the current model as a <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance or in serialized form.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The current model or its serialized form.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model">Model</a> or <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.NullMonitor.saveModel">
<span class="sig-name descname"><span class="pre">saveModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#NullMonitor.saveModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.NullMonitor.saveModel" title="Permalink to this definition"></a></dt>
<dd><p>Save the state dictionary of the <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance currently being trained or serialize the model any other way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><em>Model</em></a>) – The model to save.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.NullMonitor.savePerformanceInfo">
<span class="sig-name descname"><span class="pre">savePerformanceInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">performance_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#NullMonitor.savePerformanceInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.NullMonitor.savePerformanceInfo" title="Permalink to this definition"></a></dt>
<dd><p>Save the performance data for the current epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>performance_dict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dictionary with the performance data.</p></li>
<li><p><strong>df_smiles</strong> (<em>pd.DataFrame</em>) – A DataFrame with the SMILES of the molecules generated in the current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.monitors.NullMonitor.saveProgress">
<span class="sig-name descname"><span class="pre">saveProgress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/monitors.html#NullMonitor.saveProgress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.monitors.NullMonitor.saveProgress" title="Permalink to this definition"></a></dt>
<dd><p>Notifies the monitor of the current progress of the training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The current training step (i.e. batch).</p></li>
<li><p><strong>current_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The current epoch.</p></li>
<li><p><strong>total_steps</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The total number of training steps.</p></li>
<li><p><strong>total_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The total number of epochs.</p></li>
<li><p><strong>*args</strong> – Additional arguments depending on the model type.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments depending on the model type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-drugex.training.rewards">
<span id="drugex-training-rewards-module"></span><h2>drugex.training.rewards module<a class="headerlink" href="#module-drugex.training.rewards" title="Permalink to this heading"></a></h2>
<p>rewards</p>
<p>Created by: Martin Sicho
On: 26.06.22, 18:07</p>
<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.rewards.MinMeanSimilarityRanking">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.rewards.</span></span><span class="sig-name descname"><span class="pre">MinMeanSimilarityRanking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#MinMeanSimilarityRanking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.MinMeanSimilarityRanking" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.RankingStrategy" title="drugex.training.interfaces.RankingStrategy"><code class="xref py py-class docutils literal notranslate"><span class="pre">RankingStrategy</span></code></a></p>
<p>Revised crowding distance algorithm to rank the solutions in the same pareto frontier with Tanimoto-distance.</p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.rewards.MinMeanSimilarityRanking.calc_fps">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calc_fps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ECFP6'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#MinMeanSimilarityRanking.calc_fps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.MinMeanSimilarityRanking.calc_fps" title="Permalink to this definition"></a></dt>
<dd><p>Calculate fingerprints for a list of molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mols</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of RDKit molecules</p></li>
<li><p><strong>fp_type</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of fingerprint to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fps</strong> – List of RDKit fingerprints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.rewards.MinMeanSimilarityRanking.getFPs">
<span class="sig-name descname"><span class="pre">getFPs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#MinMeanSimilarityRanking.getFPs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.MinMeanSimilarityRanking.getFPs" title="Permalink to this definition"></a></dt>
<dd><p>Calculate fingerprints for a list of molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smiles</strong> – smiles to calculate fingerprints for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of RDKit fingerprints</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.rewards.MutualSimilaritySortRanking">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.rewards.</span></span><span class="sig-name descname"><span class="pre">MutualSimilaritySortRanking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#MutualSimilaritySortRanking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.MutualSimilaritySortRanking" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.rewards.MinMeanSimilarityRanking" title="drugex.training.rewards.MinMeanSimilarityRanking"><code class="xref py py-class docutils literal notranslate"><span class="pre">MinMeanSimilarityRanking</span></code></a></p>
<p>Alternative implementation of the <a class="reference internal" href="#drugex.training.rewards.MinMeanSimilarityRanking" title="drugex.training.rewards.MinMeanSimilarityRanking"><code class="xref any py py-class docutils literal notranslate"><span class="pre">MinMeanSimilarityRanking</span></code></a> ranking strategy that tries
to more closely emulate the crowding distance with fingerprint similarities. Adapted
from the original code by &#64;XuhanLiu (<a class="reference external" href="https://github.com/XuhanLiu/DrugEx/blob/cd384f4a8ed4982776e92293f77afd4ea78644f9/utils/nsgaii.py#L92">https://github.com/XuhanLiu/DrugEx/blob/cd384f4a8ed4982776e92293f77afd4ea78644f9/utils/nsgaii.py#L92</a>).</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.rewards.NSGAIIRanking">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.rewards.</span></span><span class="sig-name descname"><span class="pre">NSGAIIRanking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">device(type='cuda')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#NSGAIIRanking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.NSGAIIRanking" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.RankingStrategy" title="drugex.training.interfaces.RankingStrategy"><code class="xref py py-class docutils literal notranslate"><span class="pre">RankingStrategy</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.rewards.ParetoCrowdingDistance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.rewards.</span></span><span class="sig-name descname"><span class="pre">ParetoCrowdingDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranking=&lt;drugex.training.rewards.NSGAIIRanking</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#ParetoCrowdingDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.ParetoCrowdingDistance" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.RewardScheme" title="drugex.training.interfaces.RewardScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">RewardScheme</span></code></a></p>
<p>Reward scheme that uses the NSGA-II crowding distance ranking strategy to rank the solutions in the same Pareto frontier.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.rewards.ParetoTanimotoDistance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.rewards.</span></span><span class="sig-name descname"><span class="pre">ParetoTanimotoDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranking=&lt;drugex.training.rewards.MinMeanSimilarityRanking</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#ParetoTanimotoDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.ParetoTanimotoDistance" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.RewardScheme" title="drugex.training.interfaces.RewardScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">RewardScheme</span></code></a></p>
<p>Reward scheme that uses the Tanimoto distance ranking strategy to rank the solutions in the same Pareto frontier.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.rewards.WeightedSum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.rewards.</span></span><span class="sig-name descname"><span class="pre">WeightedSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranking</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/rewards.html#WeightedSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.rewards.WeightedSum" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.RewardScheme" title="drugex.training.interfaces.RewardScheme"><code class="xref py py-class docutils literal notranslate"><span class="pre">RewardScheme</span></code></a></p>
<p>Reward scheme that uses the weighted sum ranking strategy to rank the solutions.</p>
</dd></dl>

</section>
<section id="module-drugex.training.tests">
<span id="drugex-training-tests-module"></span><h2>drugex.training.tests module<a class="headerlink" href="#module-drugex.training.tests" title="Permalink to this heading"></a></h2>
<p>tests</p>
<p>Created by: Martin Sicho
On: 31.05.22, 10:20</p>
<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.tests.MockScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.tests.</span></span><span class="sig-name descname"><span class="pre">MockScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#MockScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.MockScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="drugex.training.scorers.html#drugex.training.scorers.interfaces.Scorer" title="drugex.training.scorers.interfaces.Scorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scorer</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.MockScorer.getKey">
<span class="sig-name descname"><span class="pre">getKey</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#MockScorer.getKey"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.MockScorer.getKey" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.MockScorer.getScores">
<span class="sig-name descname"><span class="pre">getScores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frags</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#MockScorer.getScores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.MockScorer.getScores" title="Permalink to this definition"></a></dt>
<dd><p>Returns the raw scores for the input molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mols</strong> (<em>list of rdkit molecules</em>) – The molecules to be scored.</p></li>
<li><p><strong>frags</strong> (<em>list of rdkit molecules</em><em>, </em><em>optional</em>) – The fragments used to generate the molecules, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scores</strong> – The scores for the molecules.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.tests.</span></span><span class="sig-name descname"><span class="pre">TestModelMonitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">submonitors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#drugex.training.interfaces.TrainingMonitor" title="drugex.training.interfaces.TrainingMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainingMonitor</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.allMethodsExecuted">
<span class="sig-name descname"><span class="pre">allMethodsExecuted</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.allMethodsExecuted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.allMethodsExecuted" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.close" title="Permalink to this definition"></a></dt>
<dd><p>Close this monitor. Training has finished.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.endStep">
<span class="sig-name descname"><span class="pre">endStep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.endStep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.endStep" title="Permalink to this definition"></a></dt>
<dd><p>Notify the monitor that a step of the training has finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current training step (i.e. batch).</p></li>
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.getModel">
<span class="sig-name descname"><span class="pre">getModel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.getModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.getModel" title="Permalink to this definition"></a></dt>
<dd><p>Return the current model as a <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance or in serialized form.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The current model or its serialized form.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model">Model</a> or <a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.passToSubmonitors">
<span class="sig-name descname"><span class="pre">passToSubmonitors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.passToSubmonitors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.passToSubmonitors" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.saveModel">
<span class="sig-name descname"><span class="pre">saveModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.saveModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.saveModel" title="Permalink to this definition"></a></dt>
<dd><p>Save the state dictionary of the <a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Model</span></code></a> instance currently being trained or serialize the model any other way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><em>Model</em></a>) – The model to save.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.savePerformanceInfo">
<span class="sig-name descname"><span class="pre">savePerformanceInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">performance_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_smiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.savePerformanceInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.savePerformanceInfo" title="Permalink to this definition"></a></dt>
<dd><p>Save the performance data for the current epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>performance_dict</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – A dictionary with the performance data.</p></li>
<li><p><strong>df_smiles</strong> (<em>pd.DataFrame</em>) – A DataFrame with the SMILES of the molecules generated in the current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestModelMonitor.saveProgress">
<span class="sig-name descname"><span class="pre">saveProgress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_epoch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestModelMonitor.saveProgress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestModelMonitor.saveProgress" title="Permalink to this definition"></a></dt>
<dd><p>Notifies the monitor of the current progress of the training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_step</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The current training step (i.e. batch).</p></li>
<li><p><strong>current_epoch</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The current epoch.</p></li>
<li><p><strong>total_steps</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The total number of training steps.</p></li>
<li><p><strong>total_epochs</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><em>optional</em>) – The total number of epochs.</p></li>
<li><p><strong>*args</strong> – Additional arguments depending on the model type.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments depending on the model type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.tests.TestScorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.tests.</span></span><span class="sig-name descname"><span class="pre">TestScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methodName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'runTest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestScorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestScorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TestCase</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TestScorer.test_getScores">
<span class="sig-name descname"><span class="pre">test_getScores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TestScorer.test_getScores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TestScorer.test_getScores" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">drugex.training.tests.</span></span><span class="sig-name descname"><span class="pre">TrainingTestCase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">methodName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'runTest'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TestCase</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.BATCH_SIZE">
<span class="sig-name descname"><span class="pre">BATCH_SIZE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.BATCH_SIZE" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.MAX_SMILES">
<span class="sig-name descname"><span class="pre">MAX_SMILES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.MAX_SMILES" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.N_EPOCHS">
<span class="sig-name descname"><span class="pre">N_EPOCHS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.N_EPOCHS" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.N_PROC">
<span class="sig-name descname"><span class="pre">N_PROC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.N_PROC" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.SEED">
<span class="sig-name descname"><span class="pre">SEED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">42</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.SEED" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.finetuning_file">
<span class="sig-name descname"><span class="pre">finetuning_file</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/home/sichom/temp/DrugEx/drugex/training/test_data/A2AR_raw_small.txt'</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.finetuning_file" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.fitTestModel">
<span class="sig-name descname"><span class="pre">fitTestModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.fitTestModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.fitTestModel" title="Permalink to this definition"></a></dt>
<dd><p>Fit a model and return the best model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#drugex.training.interfaces.Model" title="drugex.training.interfaces.Model"><em>Model</em></a>) – The model to fit</p></li>
<li><p><strong>train_loader</strong> (<em>DataLoader</em>) – The training data loader</p></li>
<li><p><strong>test_loader</strong> (<em>DataLoader</em>) – The test data loader</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The tuple of (fitted model, monitor)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.getRandomFile">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">getRandomFile</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.getRandomFile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.getRandomFile" title="Permalink to this definition"></a></dt>
<dd><p>Generate a random temporary file and return its path.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The path to the temporary file</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.getSmiles">
<span class="sig-name descname"><span class="pre">getSmiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.getSmiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.getSmiles" title="Permalink to this definition"></a></dt>
<dd><p>Read and standardize SMILES from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>_file</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The file to read from (must be a .tsv file with a column named “CANONICAL_SMILES”)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of SMILES</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.getTestEnvironment">
<span class="sig-name descname"><span class="pre">getTestEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.getTestEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.getTestEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>Get the testing environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scheme</strong> (<a class="reference internal" href="#drugex.training.interfaces.RewardScheme" title="drugex.training.interfaces.RewardScheme"><em>RewardScheme</em></a>) – The reward scheme to use. If None, the default ParetoTanimotoDistance is used.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#drugex.training.environment.DrugExEnvironment" title="drugex.training.environment.DrugExEnvironment">DrugExEnvironment</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.pretraining_file">
<span class="sig-name descname"><span class="pre">pretraining_file</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/home/sichom/temp/DrugEx/drugex/training/test_data/ZINC_raw_small.txt'</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.pretraining_file" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.scorers">
<span class="sig-name descname"><span class="pre">scorers</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[&lt;drugex.training.scorers.properties.Property</span> <span class="pre">object&gt;,</span> <span class="pre">&lt;drugex.training.scorers.qsprpred.QSPRPredScorer</span> <span class="pre">object&gt;]</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.scorers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.setUp">
<span class="sig-name descname"><span class="pre">setUp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.setUp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.setUp" title="Permalink to this definition"></a></dt>
<dd><p>Hook method for setting up the test fixture before exercising it.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.setUpSmilesFragData">
<span class="sig-name descname"><span class="pre">setUpSmilesFragData</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.setUpSmilesFragData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.setUpSmilesFragData" title="Permalink to this definition"></a></dt>
<dd><p>Create inputs for the fragment-based SMILES models.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The tuple of (pretraining training dataloader, pretraining test dataloader, finetuning training dataloader, finetuning test dataloader, vocabulary)</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.standardize">
<span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smiles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.standardize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.standardize" title="Permalink to this definition"></a></dt>
<dd><p>Standardize the input SMILES</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>smiles</strong> (<a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – The list of SMILES to standardize</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of standardized SMILES</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3.9/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.test_data_dir">
<span class="sig-name descname"><span class="pre">test_data_dir</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'/home/sichom/temp/DrugEx/drugex/training/test_data'</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.test_data_dir" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.test_graph_transformer">
<span class="sig-name descname"><span class="pre">test_graph_transformer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.test_graph_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.test_graph_transformer" title="Permalink to this definition"></a></dt>
<dd><p>Test fragment-based graph transformer model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.test_graph_transformer_scaffold">
<span class="sig-name descname"><span class="pre">test_graph_transformer_scaffold</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.test_graph_transformer_scaffold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.test_graph_transformer_scaffold" title="Permalink to this definition"></a></dt>
<dd><p>Test RL with fragment-based graph transformer model with scaffold input.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.test_sequence_rnn">
<span class="sig-name descname"><span class="pre">test_sequence_rnn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.test_sequence_rnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.test_sequence_rnn" title="Permalink to this definition"></a></dt>
<dd><p>Test sequence RNN.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.test_sequence_transformer">
<span class="sig-name descname"><span class="pre">test_sequence_transformer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.test_sequence_transformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.test_sequence_transformer" title="Permalink to this definition"></a></dt>
<dd><p>Test fragment-based sequence transformer model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.test_sequence_transformer_scaffold">
<span class="sig-name descname"><span class="pre">test_sequence_transformer_scaffold</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#TrainingTestCase.test_sequence_transformer_scaffold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.test_sequence_transformer_scaffold" title="Permalink to this definition"></a></dt>
<dd><p>Test RL with fragment-based sequence transformer model with scaffold input.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="drugex.training.tests.TrainingTestCase.thresholds">
<span class="sig-name descname"><span class="pre">thresholds</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[0.5,</span> <span class="pre">0.99]</span></em><a class="headerlink" href="#drugex.training.tests.TrainingTestCase.thresholds" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="drugex.training.tests.getPredictor">
<span class="sig-prename descclassname"><span class="pre">drugex.training.tests.</span></span><span class="sig-name descname"><span class="pre">getPredictor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/drugex/training/tests.html#getPredictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#drugex.training.tests.getPredictor" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-drugex.training">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-drugex.training" title="Permalink to this heading"></a></h2>
<p>__init__.py</p>
<p>Created by: Martin Sicho
On: 31.05.22, 10:20</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="drugex.parallel.html" class="btn btn-neutral float-left" title="drugex.parallel package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="drugex.training.explorers.html" class="btn btn-neutral float-right" title="drugex.training.explorers package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Xuhan Liu, Sohvi Lukkonen, Helle van den Maagdenberg, Linde Schoenmaker, Martin Sicho.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>