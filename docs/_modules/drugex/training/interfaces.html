<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>drugex.training.interfaces &mdash; DrugEx 3.1.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> DrugEx
          </a>
              <div class="version">
                v3.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">Welcome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../use.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../use.html#cli-example">CLI Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../use.html#cli-options">CLI Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/modules.html">DrugEx Python API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">DrugEx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Module code</a> &raquo;</li>
      <li>drugex.training.interfaces</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for drugex.training.interfaces</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">interfaces</span>

<span class="sd">Created by: Martin Sicho</span>
<span class="sd">On: 01.06.22, 11:29</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>

<span class="kn">from</span> <span class="nn">drugex</span> <span class="kn">import</span> <span class="n">DEFAULT_GPUS</span><span class="p">,</span> <span class="n">DEFAULT_DEVICE</span>
<span class="kn">from</span> <span class="nn">drugex.utils</span> <span class="kn">import</span> <span class="n">gpu_non_dominated_sort</span><span class="p">,</span> <span class="n">cpu_non_dominated_sort</span>


<div class="viewcode-block" id="ModelEvaluator"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.ModelEvaluator">[docs]</a><span class="k">class</span> <span class="nc">ModelEvaluator</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple function to score a model based on the generated molecules and input fragments if applicable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">frags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Score molecules.</span>

<span class="sd">        Args:</span>
<span class="sd">            mols: molecules to score</span>
<span class="sd">            frags: given input fragments</span>

<span class="sd">        Returns:</span>
<span class="sd">            scores (DataFrame): a data frame with columns name &#39;VALID&#39; and &#39;DESIRE&#39; indicating the validity of the SMILES and the degree of desirability</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="ScoreModifier"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.ScoreModifier">[docs]</a><span class="k">class</span> <span class="nc">ScoreModifier</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines a function to modify a score value.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the modifier on x.</span>
<span class="sd">        Args:</span>
<span class="sd">            x: float or np.array to modify</span>
<span class="sd">        Returns:</span>
<span class="sd">            float or np.array (depending on the type of x) after application of the distance function.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Scorer"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Scorer">[docs]</a><span class="k">class</span> <span class="nc">Scorer</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used by the `Environment` to calculate customized scores.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modifier</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span> <span class="o">=</span> <span class="n">modifier</span>

<div class="viewcode-block" id="Scorer.getScores"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Scorer.getScores">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">getScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">frags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns scores for the input molecules.</span>

<span class="sd">        Args:</span>
<span class="sd">            mols: molecules to score</span>
<span class="sd">            frags: input fragments</span>

<span class="sd">        Returns:</span>
<span class="sd">            scores (list): `list` of scores for &quot;mols&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mols</span><span class="p">,</span> <span class="n">frags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Actual call method. Modifies the scores before returning them.</span>

<span class="sd">        Args:</span>
<span class="sd">            mols: molecules to score</span>
<span class="sd">            frags: input fragments</span>

<span class="sd">        Returns:</span>
<span class="sd">            scores (DataFrame): a data frame with columns name &#39;VALID&#39; and &#39;DESIRE&#39; indicating the validity of the SMILES and the degree of desirability</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getModifiedScores</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getScores</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">frags</span><span class="p">))</span>

<div class="viewcode-block" id="Scorer.getModifiedScores"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Scorer.getModifiedScores">[docs]</a>    <span class="k">def</span> <span class="nf">getModifiedScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scores</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Modify the scores with the given `ScoreModifier`.</span>

<span class="sd">        Args:</span>
<span class="sd">            scores:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scores</span></div>

<div class="viewcode-block" id="Scorer.getKey"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Scorer.getKey">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">getKey</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Scorer.setModifier"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Scorer.setModifier">[docs]</a>    <span class="k">def</span> <span class="nf">setModifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modifier</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span> <span class="o">=</span> <span class="n">modifier</span></div>

<div class="viewcode-block" id="Scorer.getModifier"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Scorer.getModifier">[docs]</a>    <span class="k">def</span> <span class="nf">getModifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifier</span></div></div>

<div class="viewcode-block" id="RankingStrategy"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.RankingStrategy">[docs]</a><span class="k">class</span> <span class="nc">RankingStrategy</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ranks the given molecules according to their scores.</span>

<span class="sd">    The implementing classes can get a paretor from by calling `RankingStrategy.getParetoFronts()` on the input scores.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">DEFAULT_DEVICE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor allows to specify a GPU or CPU device for Pareto fronts calculation.</span>

<span class="sd">        Args:</span>
<span class="sd">            device:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>

<div class="viewcode-block" id="RankingStrategy.getParetoFronts"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.RankingStrategy.getParetoFronts">[docs]</a>    <span class="k">def</span> <span class="nf">getParetoFronts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scores</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns Pareto fronts.</span>

<span class="sd">        Args:</span>
<span class="sd">            scores: matrix of scores for the multiple objectives</span>

<span class="sd">        Returns:</span>
<span class="sd">            fronts (list): `list` of Pareto fronts.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">):</span>
            <span class="n">swarm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">gpu_non_dominated_sort</span><span class="p">(</span><span class="n">swarm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cpu_non_dominated_sort</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span></div>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">scores</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return ranks of the molecules based on the given scores.</span>

<span class="sd">        Args:</span>
<span class="sd">            smiles: SMILES of the molecules</span>
<span class="sd">            scores: the matrix of scores (&quot;len(smiles) x len(objectives)&quot;)</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>


<div class="viewcode-block" id="RewardScheme"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.RewardScheme">[docs]</a><span class="k">class</span> <span class="nc">RewardScheme</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reward scheme that enables ranking of molecules based on the calculated objectives and other criteria.</span>
<span class="sd">    &quot;&quot;&quot;</span>


<div class="viewcode-block" id="RewardScheme.RewardException"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.RewardScheme.RewardException">[docs]</a>    <span class="k">class</span> <span class="nc">RewardException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exception to catch errors in the calculation of rewards.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ranking</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The `RankingStrategy` function to use for ranking solutions.</span>

<span class="sd">        Args:</span>
<span class="sd">            ranking: a `RankingStrategy`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ranking</span> <span class="o">=</span> <span class="n">ranking</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">desire</span><span class="p">,</span> <span class="n">undesire</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the rewards for generated molecules and rank them according to teh given `RankingStrategy`.</span>

<span class="sd">        Args:</span>
<span class="sd">            smiles (list): SMILES strings of the generated molecules</span>
<span class="sd">            scores (DataFrame): the full scoring table (&quot;len(smiles) x len(thresholds)&quot;)</span>
<span class="sd">            valid (list):  ratio of valid molecules</span>
<span class="sd">            desire (list): ratio of desired molecules</span>
<span class="sd">            undesire (list): ratio of undesired molecules</span>
<span class="sd">            thresholds (list): score thresholds for the calculated scores in &quot;scores&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            rewards (list): rewards based on</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="Environment"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Environment">[docs]</a><span class="k">class</span> <span class="nc">Environment</span><span class="p">(</span><span class="n">ModelEvaluator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Definition of the generic environment class for DrugEx. Reference implementation is `DrugExEnvironment`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scorers</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reward_scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize environment with objective functions and their desirability thresholds. Molecules scoring above thresholds are desirable.</span>

<span class="sd">        Args:</span>
<span class="sd">            scorers: scoring functions to calculate the objective functions for molecules</span>
<span class="sd">            thresholds: desirability thresholds for each scoring function (passed to the reward scheme as well), should be the same length as &quot;scorers&quot;. If `None`, they will be set to 0.99.</span>
<span class="sd">            reward_scheme: a `RewardScheme`, predefined schemes are available in `drugex.training.rewards`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scorers</span> <span class="o">=</span> <span class="n">scorers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span> <span class="o">=</span> <span class="n">thresholds</span> <span class="k">if</span> <span class="n">thresholds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="mf">0.99</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">scorers</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scorers</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rewardScheme</span> <span class="o">=</span> <span class="n">reward_scheme</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">frags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getScores</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">frags</span><span class="p">)</span>

<div class="viewcode-block" id="Environment.getScores"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Environment.getScores">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">getScores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">frags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the scores of all objectives for all of samples</span>
<span class="sd">        Args:</span>
<span class="sd">            smiles (list): the list of generated molecules</span>
<span class="sd">            frags (list): the list of input fragments</span>

<span class="sd">        Returns:</span>
<span class="sd">            scores (DataFrame): The scores of all objectives for all of samples which also includes validity</span>
<span class="sd">                and desirability for each SMILES.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="Environment.getRewards"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Environment.getRewards">[docs]</a>    <span class="k">def</span> <span class="nf">getRewards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">smiles</span><span class="p">,</span> <span class="n">frags</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the single value as the reward for each molecule used for reinforcement learning</span>
<span class="sd">        Args:</span>
<span class="sd">            smiles (List):  a list of SMILES-based molecules</span>

<span class="sd">        Returns:</span>
<span class="sd">            rewards (np.ndarray): n-d array in which the element is the reward for each molecule, and</span>
<span class="sd">                n is the number of array which equals to the size of smiles.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getScores</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">frags</span><span class="o">=</span><span class="n">frags</span><span class="p">)</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">VALID</span><span class="o">.</span><span class="n">values</span>
        <span class="n">desire</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">DESIRE</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">undesire</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">-</span> <span class="n">desire</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">getScorerKeys</span><span class="p">()]</span><span class="o">.</span><span class="n">values</span>

        <span class="n">rewards</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rewardScheme</span><span class="p">(</span><span class="n">smiles</span><span class="p">,</span> <span class="n">scores</span><span class="p">,</span> <span class="n">valid</span><span class="p">,</span> <span class="n">desire</span><span class="p">,</span> <span class="n">undesire</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">)</span>
        <span class="n">rewards</span><span class="p">[</span><span class="n">valid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">rewards</span></div>

<div class="viewcode-block" id="Environment.getScorerKeys"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Environment.getScorerKeys">[docs]</a>    <span class="k">def</span> <span class="nf">getScorerKeys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">getKey</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scorers</span><span class="p">]</span></div></div>

<div class="viewcode-block" id="ModelProvider"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.ModelProvider">[docs]</a><span class="k">class</span> <span class="nc">ModelProvider</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Any instance that contains a DrugEx `Model` or its serialized form (i.e a state dictionary).</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ModelProvider.getModel"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.ModelProvider.getModel">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">getModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the current model as a `Model` instance or in serialized form.</span>

<span class="sd">        Returns:</span>
<span class="sd">            model (`Model` or serialized states)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div></div>

<div class="viewcode-block" id="Model"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Model">[docs]</a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">,</span> <span class="n">ModelProvider</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic base class for all PyTorch models in DrugEx. Manages the GPU or CPU gpus available to the model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">DEFAULT_DEVICE</span><span class="p">,</span> <span class="n">use_gpus</span><span class="o">=</span><span class="n">DEFAULT_GPUS</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpus</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateDevices</span><span class="p">(</span><span class="n">device</span><span class="p">,</span> <span class="n">use_gpus</span><span class="p">)</span>

<div class="viewcode-block" id="Model.updateDevices"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Model.updateDevices">[docs]</a>    <span class="k">def</span> <span class="nf">updateDevices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">gpus</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">device</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;cpu&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gpus</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span>
        <span class="k">elif</span> <span class="n">device</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;cuda&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cuda:</span><span class="si">{</span><span class="n">gpus</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attachToGPUs</span><span class="p">(</span><span class="n">gpus</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown device: </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Model.attachToGPUs"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Model.attachToGPUs">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">attachToGPUs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpus</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use this method to handle a request to change the used GPUs. This method is automatically called when the class is instantiated, but may need to be called again in subclasses to move all data to the required devices.</span>

<span class="sd">        Subclasses should also make sure to set &quot;self.device&quot; to the currently used device and &quot;self.gpus&quot; to GPU ids of the currently used GPUs</span>

<span class="sd">        Args:</span>
<span class="sd">            gpus: a `tuple` of new GPU IDs</span>

<span class="sd">        Returns:</span>
<span class="sd">            `None`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="Model.fit"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Model.fit">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Train and validate the model with a given training and validation loader (see `DataSet` and its implementations docs to learn how to generate them).</span>

<span class="sd">        Args:</span>
<span class="sd">            train_loader: PyTorch `DataLoader` with training data.</span>
<span class="sd">            valid_loader: PyTorch `DataLoader` with validation data.</span>
<span class="sd">            epochs: number of epochs for training the model</span>
<span class="sd">            monitor: a `TrainingMonitor`</span>

<span class="sd">        Returns:</span>
<span class="sd">            `None`</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="Model.loadStatesFromFile"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Model.loadStatesFromFile">[docs]</a>    <span class="k">def</span> <span class="nf">loadStatesFromFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the model states from a file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: path to file</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">loadStates</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">map_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">))</span></div>


<div class="viewcode-block" id="Model.loadStates"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Model.loadStates">[docs]</a>    <span class="k">def</span> <span class="nf">loadStates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Generator"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Generator">[docs]</a><span class="k">class</span> <span class="nc">Generator</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The base generator class for fitting and evaluating a DrugEx generator.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Generator.fit"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Generator.fit">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">evaluator</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Start training.</span>

<span class="sd">        Args:</span>
<span class="sd">            train_loader: training data loader (see `DataSet`)</span>
<span class="sd">            valid_loader: testing data loader (see `DataSet`)</span>
<span class="sd">            epochs: maximum number of epochs for which to train</span>
<span class="sd">            evaluator: a `ModelEvaluator`</span>
<span class="sd">            monitor:</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="Generator.evaluate"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Generator.evaluate">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">drop_duplicates</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Generator.sample"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Generator.sample">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">pass</span></div></div>

<div class="viewcode-block" id="Explorer"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Explorer">[docs]</a><span class="k">class</span> <span class="nc">Explorer</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements the DrugEx exploration strategy for DrugEx models under the reinforcement learning framework.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agent</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">mutate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">crover</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="n">repeat</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">DEFAULT_DEVICE</span><span class="p">,</span> <span class="n">use_gpus</span><span class="o">=</span><span class="n">DEFAULT_GPUS</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span> <span class="n">use_gpus</span><span class="o">=</span><span class="n">use_gpus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agent</span> <span class="o">=</span> <span class="n">agent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutate</span> <span class="o">=</span> <span class="n">mutate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crover</span> <span class="o">=</span> <span class="n">crover</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batchSize</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">repeat</span> <span class="o">=</span> <span class="n">repeat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nSamples</span> <span class="o">=</span> <span class="n">n_samples</span>

<div class="viewcode-block" id="Explorer.attachToGPUs"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Explorer.attachToGPUs">[docs]</a>    <span class="k">def</span> <span class="nf">attachToGPUs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpus</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;agent&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">attachToGPUs</span><span class="p">(</span><span class="n">gpus</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;mutate&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mutate</span><span class="o">.</span><span class="n">attachToGPUs</span><span class="p">(</span><span class="n">gpus</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;crover&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">crover</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crover</span><span class="o">.</span><span class="n">attachToGPUs</span><span class="p">(</span><span class="n">gpus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpus</span> <span class="o">=</span> <span class="n">gpus</span></div>

<div class="viewcode-block" id="Explorer.fit"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Explorer.fit">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">valid_loader</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="Explorer.getModel"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.Explorer.getModel">[docs]</a>    <span class="k">def</span> <span class="nf">getModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the current state of the agent</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agent</span><span class="o">.</span><span class="n">state_dict</span><span class="p">())</span></div></div>

<div class="viewcode-block" id="TrainingMonitor"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.TrainingMonitor">[docs]</a><span class="k">class</span> <span class="nc">TrainingMonitor</span><span class="p">(</span><span class="n">ModelProvider</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interface used to monitor model training.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TrainingMonitor.saveModel"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.TrainingMonitor.saveModel">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">saveModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the state dictionary of the `Model` instance currently being trained or serialize the model any other way.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: a DrugEx `Model`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="TrainingMonitor.savePerformanceInfo"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.TrainingMonitor.savePerformanceInfo">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">savePerformanceInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">current_epoch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save performance data.</span>

<span class="sd">        Args:</span>
<span class="sd">            current_step: Current training step (batch).</span>
<span class="sd">            current_epoch: Current epoch.</span>
<span class="sd">            loss: current value of the training loss</span>
<span class="sd">            *args: other arguments depending on the model type</span>
<span class="sd">            **kwargs: other keyword arguments depending on the model type</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="TrainingMonitor.saveProgress"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.TrainingMonitor.saveProgress">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">saveProgress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">current_epoch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">total_steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">total_epochs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notifies the monitor of the current progress of the training.</span>

<span class="sd">        Args:</span>
<span class="sd">            current_step: Current training step (batch).</span>
<span class="sd">            current_epoch: Current epoch.</span>
<span class="sd">            total_steps: Total number of training steps (batches).</span>
<span class="sd">            total_epochs: Total number of epochs.</span>
<span class="sd">            *args: other arguments depending on the model type</span>
<span class="sd">            **kwargs: other keyword arguments depending on the model type</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="TrainingMonitor.endStep"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.TrainingMonitor.endStep">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">endStep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">epoch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notify the monitor that a step of the training has finished.</span>

<span class="sd">        Args:</span>
<span class="sd">            step: Current training step (batch).</span>
<span class="sd">            epoch: Current epoch.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>

<div class="viewcode-block" id="TrainingMonitor.close"><a class="viewcode-back" href="../../../api/drugex.training.html#drugex.training.interfaces.TrainingMonitor.close">[docs]</a>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close this monitor. Training has finished.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Xuhan Liu, Sohvi Lukkonen, Helle van den Maagdenberg, Linde Schoenmaker, Martin Sicho.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>